"use strict";var magways=magways||{};function magwaysDomReady(e){if("function"==typeof e){if("interactive"===document.readyState||"complete"===document.readyState)return e();document.addEventListener("DOMContentLoaded",e,!1)}}magways.traverseMenu={init:function(){let e=document.querySelector(".magways-top-nav"),t=document.getElementById("site-navigation");e&&this.traverse(e),t&&this.traverse(t)},traverse:function(e){let t=e.getElementsByTagName("ul")[0];if(void 0!==t){t.classList.contains("nav-menu")||t.classList.add("nav-menu");let a=t.getElementsByTagName("a"),s=t.querySelectorAll(".menu-item-has-children > a, .page_item_has_children > a");for(let i of a)i.addEventListener("focus",this.toggleFocus,!0),i.addEventListener("blur",this.toggleFocus,!0);for(let o of s)o.addEventListener("touchstart",this.toggleFocus,!1)}},toggleFocus:function(e){if("focus"===e.type||"blur"===e.type){let t=this;for(;!t.classList.contains("nav-menu");)"li"===t.tagName.toLowerCase()&&t.classList.toggle("focus"),t=t.parentNode}if("touchstart"===e.type){let a=this.parentNode;for(let s of(e.preventDefault(),a.parentNode.children))a!==s&&s.classList.remove("focus");a.classList.toggle("focus")}}},magways.handleFocus={init:function(){this.keepFocusInModal()},keepFocusInModal:function(){let e=document.querySelectorAll(".magways-canvas-modal");document.addEventListener("keydown",function(t){("Tab"===t.key||9===t.keyCode)&&e&&e.forEach(function(e){let a=e.querySelectorAll('a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="search"]:not([disabled]), input[type="submit"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])'),s=a[0],i=a[a.length-1];t.shiftKey?document.activeElement===s&&(i.focus(),t.preventDefault()):document.activeElement===i&&(s.focus(),t.preventDefault())})})}},magways.fadeOutPreloader={init:function(){let e=document.querySelector("#magways-preloader-wrapper");e&&(e.classList.add("fadeOut"),setTimeout(function(){e.style.display="none"},1e3))}},magways.scrollToTop={init:function(){let e=document.documentElement,t=this,a=document.querySelectorAll(".magways-toggle-scroll-top");a&&a.forEach(function(a){t.goToTop(a,e)});let s=document.querySelectorAll(".magways-floating-scroll-top");s&&s.forEach(function(a){t.scrollToTopPosition(a,e)})},goToTop:function(e,t){e.addEventListener("click",function(e){e.preventDefault(),t.scrollTo({top:0,behavior:"smooth"})})},scrollToTopPosition:function(e,t){window.addEventListener("scroll",function(a){let s=t.scrollHeight-t.clientHeight;t.scrollTop/s>.4?e.classList.add("visible"):e.classList.remove("visible")})}},magways.stickyMenu={init:function(){let e=document.querySelector(".magways-primary-bar-row.sticky-menu");if(e&&e.className.includes("sticky-style-normal")){let t=e.offsetTop+e.clientHeight+100;window.addEventListener("scroll",function(a){let s=window.scrollY;if(s<=e.offsetTop||0===s){e.classList.remove("has-menu-sticked"),e.classList.remove("sticky-menu-translate-up");return}s>e.offsetTop&&(e.classList.add("sticky-menu-translate-up"),e.classList.remove("has-menu-sticked")),s>t&&(e.classList.remove("sticky-menu-translate-up"),e.classList.add("has-menu-sticked"))})}}},magways.subMenuToggle={init:function(){let e=document.querySelectorAll(".sub-menu-toggle");e&&e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),this.classList.toggle("active"),this.setAttribute("aria-selected",`${"true"!==this.getAttribute("aria-selected")}`);let t=this.getAttribute("data-toggle-target");t&&document.querySelector(t).classList.toggle("active")})})}},magways.CanvasModal={init:function(){document.querySelector(".toggle-canvas-modal")&&(this.onOpen(),this.onClose(),this.outsideModal(),this.closeOnEscape())},onOpen:function(){document.querySelectorAll(".toggle-canvas-modal").forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),document.body.classList.add("canvas-modal-is-open"),document.body.classList.add(this.getAttribute("data-body-class")),e.classList.add("active"),e.setAttribute("aria-expanded",!0);let a=this.getAttribute("data-focus");a&&setTimeout(function(){document.querySelector(a).focus()},500)})})},onClose:function(){document.querySelectorAll(".close-canvas-modal").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),this.hideModal()}).bind(this))}).bind(this))},outsideModal:function(){document.addEventListener("click",(function(e){if(document.body.classList.contains("canvas-modal-is-open")){let t=document.querySelector("#page.site");e.target==t&&this.hideModal()}}).bind(this))},closeOnEscape:function(){document.addEventListener("keydown",(function(e){"Escape"===e.key&&(e.preventDefault(),this.hideModal())}).bind(this))},hideModal:function(){document.body.classList.remove("canvas-modal-is-open");let e=document.querySelector(".toggle-canvas-modal.active");if(e){document.body.classList.remove(e.getAttribute("data-body-class"));let t=e.getAttribute("data-focus");t&&document.querySelector(t).blur(),e.setAttribute("aria-expanded",!1),e.focus(),e.classList.remove("active")}}},magways.SearchBlock={isToggled:!1,init:function(){document.querySelector(".toggle-search-block")&&(this.toggleSearchBlock(),this.closeOnEscape())},toggleSearchBlock:function(){let e=this;document.querySelectorAll(".toggle-search-block").forEach(function(t){t.addEventListener("click",function(a){if(a.preventDefault(),e.isToggled=!e.isToggled,e.isToggled){document.body.classList.add("search-block-is-open"),document.body.classList.add(this.getAttribute("data-body-class")),t.classList.add("active"),t.parentNode.classList.add("active"),t.setAttribute("aria-expanded",!0);let s=this.getAttribute("data-focus");s&&setTimeout(function(){t.parentNode.querySelector(s).focus()},500),setTimeout(function(){e.outsideBlock()},100)}else e.hideBlock()})})},closeOnEscape:function(){let e=this;document.addEventListener("keydown",function(t){"Escape"===t.key&&(t.preventDefault(),e.hideBlock())})},outsideBlock:function(){document.addEventListener("click",this.handleClickOutsideBox)},handleClickOutsideBox:function(e){document.body.classList.contains("search-block-is-open")&&(document.querySelector(".magways-search-toggle.active .em-search-form-inner").contains(e.target)||magways.SearchBlock.hideBlock())},hideBlock:function(){let e=this;document.body.classList.remove("search-block-is-open");let t=document.querySelector(".toggle-search-block.active");if(t){document.body.classList.remove(t.getAttribute("data-body-class"));let a=t.getAttribute("data-focus");a&&t.parentNode.querySelector(a).blur(),t.setAttribute("aria-expanded",!1),t.focus(),t.classList.remove("active"),t.parentNode.classList.remove("active"),document.removeEventListener("click",e.handleClickOutsideBox),e.isToggled=!1}}},magways.setBackgroundImage={init:function(){let e=document.querySelectorAll(".magways-bg-image");e&&e.forEach(function(e){let t=e.querySelector("img");if(t){let a=t.getAttribute("src");a&&(e.style.backgroundImage="url("+a+")",t.style.display="none")}})}},magways.progressBar={init:function(){let e=document.getElementById("magways-progress-bar");if(e){let t=document.body,a=document.documentElement;window.addEventListener("scroll",function(s){let i=t.scrollTop||a.scrollTop,o=a.scrollHeight-a.clientHeight;e.style.width=i/o*100+"%"})}}},magways.slider={init:function(){this.tickerSlider(),this.bannerSlider(),this.widgetSlider()},tickerSlider:function(){let e=document.querySelector(".magways-ticker-slider-wrapper");if(e){let t,a=e.getAttribute("data-slider")||{};a&&(t=JSON.parse(a)),new Swiper(e,t)}},bannerSlider:function(){let e=document.querySelector(".magways-banner-wrapper");if(e){let t={loop:!0},a,s,i,o=document.querySelector(".magways-banner-thumb-container");if(o){let n=o.getAttribute("data-banner-thumb")||{};n&&(i=JSON.parse(n),a=new Swiper(o,i),t.loop=!1,t.thumbs={swiper:a},t.on={slideChange:function(){let e=this.activeIndex+1;document.querySelector(`.magways-banner-thumb-container .swiper-slide:nth-child(${e})`);let t=document.querySelector(`.magways-banner-thumb-container .swiper-slide:nth-child(${e+1})`),a=document.querySelector(`.magways-banner-thumb-container .swiper-slide:nth-child(${e-1})`);t&&!t.classList.contains("swiper-slide-visible")?this.thumbs.swiper.slideNext():a&&!a.classList.contains("swiper-slide-visible")&&this.thumbs.swiper.slidePrev()}})}let l=e.getAttribute("data-banner")||{};l&&(s=JSON.parse(l));let r={...t,...s};new Swiper(e,r)}},widgetSlider:function(){let e=document.querySelectorAll(".magways-slider-wrapper-block .swiper");e&&e.forEach(function(e){let t=e.parentNode,a=t.querySelector(".swiper-button-next"),s=t.querySelector(".swiper-button-prev"),i=t.querySelector(".swiper-pagination"),o=e.getAttribute("data-slider")||{};if(o)var n=JSON.parse(o);let l={slidesPerView:1,lazyloading:!0,navigation:{nextEl:a,prevEl:s},pagination:{el:i,clickable:!0},...n},r=new Swiper(e,l);e.clientWidth<500&&(r.params.slidesPerView=1,r.update())})}},magways.tabs={init:function(){let e=document.querySelectorAll("[data-toggle='uf-tab']");e&&e.forEach(function(e){e.addEventListener("click",function(t){t.preventDefault();let a=[...e.parentNode.children],s=[...e.parentNode.nextElementSibling.children,];a.forEach(e=>{e.classList.remove("active"),e.setAttribute("aria-selected","false")}),s.forEach(e=>{e.classList.remove("active")});let i=e.getAttribute("aria-controls"),o=document.getElementById(i);e.classList.add("active"),e.setAttribute("aria-selected","true"),o.classList.add("active")})})}},magways.loadPosts={canBeLoaded:!0,currentPage:0,nextPage:0,maxPage:0,template:"",loadButton:"",loader:"",postsListsWrapper:"",loadType:"",init:function(){let e=document.querySelector(".magways-load-posts-btn-wrapper");if(e){let t=this;t.currentPage=parseInt(e.getAttribute("data-page")),t.nextPage=t.currentPage+1,t.maxPage=parseInt(e.getAttribute("data-max-pages")),t.template=e.closest("#primary").getAttribute("data-template"),t.loadButton=document.querySelector(".magways-ajax-load-btn"),t.loader=document.querySelector(".magways-ajax-loader"),t.postsListsWrapper=document.querySelector(".magways-posts-lists"),t.loadType=e.getAttribute("data-load-type"),t.loadType||(t.loadType="button_click_load"),"button_click_load"==t.loadType&&t.loadButton.addEventListener("click",function(e){e.preventDefault(),t.canBeLoaded&&t.fetchThePosts()}),"infinite_scroll_load"==t.loadType&&(e.style.opacity=.7,window.addEventListener("scroll",function(a){let s=e.getBoundingClientRect().top-window.innerHeight<=400;t.nextPage<=t.maxPage&&s&&t.canBeLoaded&&t.fetchThePosts()}))}},fetchThePosts:function(){let e=this;e.canBeLoaded=!1,e.loadButton.classList.add("loading-posts"),e.loader.classList.add("active");let t={action:"magways_load_posts",load_post_nonce:MagwaysVars.load_post_nonce,query_vars:MagwaysVars.query_vars,page:e.nextPage,template:e.template};fetch(MagwaysVars.ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(t)}).then(e=>e.json()).then(t=>{if(t.success){let a=t.data.content.join("");magways.createElementsFromString(a).forEach(t=>{t.classList.add("animatefadeIn"),e.postsListsWrapper.appendChild(t)}),e.currentPage=e.nextPage,e.nextPage++,e.canBeLoaded=!0,e.nextPage<=e.maxPage?(e.loadButton.classList.remove("loading-posts"),e.loader.classList.remove("active")):document.querySelector(".magways-load-posts-btn-wrapper").style.display="none",document.body.dispatchEvent(new Event("posts-loaded"))}else e.loadButton.classList.remove("loading-posts"),e.loader.classList.remove("active")}).catch(t=>{console.error("Error during fetch:",t),e.loadButton.classList.remove("loading-posts"),e.loader.classList.remove("active")})}},magways.createElementsFromString=function(e){let t=new DOMParser,a=t.parseFromString(e,"text/html");return Array.from(a.body.children)},magwaysDomReady(function(){magways.stickyMenu.init(),magways.subMenuToggle.init(),magways.traverseMenu.init(),magways.handleFocus.init(),magways.CanvasModal.init(),magways.SearchBlock.init(),magways.scrollToTop.init(),magways.setBackgroundImage.init(),magways.progressBar.init(),magways.slider.init(),magways.tabs.init(),magways.loadPosts.init()}),window.addEventListener("load",function(e){magways.fadeOutPreloader.init()});